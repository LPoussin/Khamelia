{% extends 'base.html.twig' %}

{% block title %}InetSCHOOLS - Enseigne/Matière{% endblock %}
{% block stylesheets %}
	
	<link rel="stylesheet" href="{{ asset('assets/vendor/select2/select2.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/jquery-datatables-bs3/assets/css/datatables.css') }} " />
	<link rel="stylesheet" href="{{ asset('assets/vendor/pnotify/pnotify.custom.css') }} " />
	<link rel="stylesheet" href="{{ asset('assets/vendor/jquery-ui/css/ui-lightness/jquery-ui-1.10.4.custom.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/select2/select2.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-multiselect/bootstrap-multiselect.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-tagsinput/bootstrap-tagsinput.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-colorpicker/css/bootstrap-colorpicker.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-timepicker/css/bootstrap-timepicker.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/dropzone/css/basic.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/dropzone/css/dropzone.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-markdown/css/bootstrap-markdown.min.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/summernote/summernote.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/summernote/summernote-bs3.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/codemirror/lib/codemirror.css') }}" />
	<link rel="stylesheet" href="{{ asset('assets/vendor/codemirror/theme/monokai.css') }}" />

{% endblock %}

{% block position %}
	{{ position }}
{% endblock %}

{% block chemin %}
	{{ chemin }}
{% endblock %}

{% block body %}
<div class="row">
    <div class="col-md-6 col-lg-12 col-xl-6">
        <section class="panel">
            <header class="panel-heading">
                <div class="panel-actions">
                    <a href="#modalFormNew" class="modal-with-form">
                        <button class="mb-xs mt-xs mr-xs btn btn-success">
                            <span class="fa fa-plus"></span>
                            Nouvelle classe
                        </button>
                    </a>
                     <div id="modalFormNew" class="modal-block modal-block-primary mfp-hide">
						<section class="panel">
							<header class="panel-heading">
								<h2 class="panel-title">Choisissez un type d'enseigne</h2>
							</header>
							<div class="panel-body">
								<form action="{{ path('classe_type') }}" method="post">
									<input type="hidden" name="_token" value="{{ csrf_token('new-item') }}"/>
									<input type="hidden" value="{{ id_enseigne }}" name="id_enseigne">
									<div class="form-group mt-lg">
										<label class="col-sm-3 control-label">Type de l'enseigne</label>
										<div class="col-sm-9">
											<select class="form-control" id="ms_example6" name="types" required="required">
												{% for ensTypeEns in typeEnsArray %}

													<option 
													value="{{ ensTypeEns.id }}" 
													>{{ ensTypeEns.libelle }}</option>
												{% endfor %}
												</optgroup>
											</select>
										</div>	
									</div>
															
									<div class="form-group text-right pr-md">
										<input type="submit" value="Continuer" class="btn btn-primary">
									</div>
								</form>
							</div>
							<footer class="panel-footer">
								<div class="row">
									<div class="col-md-12 text-right">
										<button class="btn btn-default modal-dismiss">Annuler</button>
									</div>
								</div>
							</footer>
						</section>
					</div>
                    <a href="#" class="fa fa-caret-down"></a>
                    
                </div>
        
                <h2 class="panel-title">
                   Liste de vos classes
                </h2>
                
            </header>
            <div class="panel-body">
                <table class="table table-bordered table-striped mb-none " {% if classes is not empty %}id="datatable-default"{% endif %}>
                    <thead >
                        <tr >
                            <th class="center">Niveau d'étude</th>
                            <th class="center">Série</th>
                            <th class="center">Professeur Principale</th>
                            <th class="center">Libelle</th>
                            <th class="center">actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    	{% for item in classes %}
                    		<tr>
                    			<td>{{ item.niveau.libelle }}</td>
                    			<td>{{ item.serie ? item.serie.libelle : 'Aucune' }}</td>
                    			{#<td>{{ item.professeurPrincipale.nom }} {{ item.professeurPrincipale.prenom }}</td>#}
                    			<!--ril-->
                    			<td>{{ item.professeurPrincipale ? item.professeurPrincipale.nom~" "~item.professeurPrincipale.prenom : "Aucun"}}</td>
                    			<td>{{ item.libelle }}</td>
                    			<td>
                    				<a href="{{ path('classe_edit', {'id' : item.id}) }} " 
										class="mb-xs mt-xs mr-xs btn btn-primary">
	                                    <span class="fa fa-edit"></span>
	                                    Mise à jour
	                                </a>

									<a href="#modalDetails-{{ item.id }}" 
										class="mb-xs mt-xs mr-xs btn btn-info modal-with-form">
										<span class="fa fa-info"></span>
	                                    Professeurs
									</a>
									<div id="modalDetails-{{ item.id }}" class="modal-block modal-block-primary mfp-hide">
										<section class="panel">
                                            <header class="panel-heading">
                                                <h2 class="panel-title">Matières associées au niveau : {{ item.niveau.libelle }}</h2>
                                            </header>
                                            <div class="panel-body">
												{% for val in item.niveau.assocMatiereNiveaux %}
													<li class="nav-parent">
														<a>
															<i class="fa fa-book" aria-hidden="true"></i>
															<span>{{ val.matiere.libelle }}</span>
														</a>
														<ul class="nav nav-children">
															{% for prof in val.matiere.professeurMatieres %}
																<li class="ml-md">
																	<i class="fa fa-user" aria-hidden="true"></i>
																	{{ prof.idProf.nom }} {{ prof.idProf.prenom }}
																	{% if prof.idProf not in item.professeurs %}
																	 	<a href="#modalValidation-{{ prof.idProf.id }}" class="modal-basic btn btn-default col-sm-1 p-0 mr-md">
                                                                            <i class="fa fa-plus"></i>
                                                                        </a>
                                                                        <div id="modalValidation-{{ prof.idProf.id }}" 
                                                                            class="modal-block modal-block-primary mfp-hide">
                                                                            <section class="panel">
                                                                                <header class="panel-heading">
                                                                                    <h2 class="panel-title">Attention</h2>
                                                                                </header>
                                                                                <div class="panel-body text-center">
                                                                                    <div class="modal-wrapper">
                                                                                        <div class="modal-icon center">
                                                                                            <i class="fa fa-question-circle"></i>
                                                                                        </div>
                                                                                        <div class="modal-text">
                                                                                            <h4>Attention</h4>
                                                                                            <p>Êtes-vous sur de vouloir associés ce professeur à cette classe?</p>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <footer class="panel-footer">
                                                                                    <div class="row">
                                                                                        <div class="col-md-12 text-right">
                                                                                            <a href="{{ path('classe_add_enseignant', {"id_user": prof.idProf.id, "id_classe": item.id, "id_matiere": val.matiere.id}) }}">
                                                                                                <button class="btn btn-primary">Oui</button>
                                                                                            </a>
                                                                                            <button class="btn btn-default modal-dismiss">Non</button>
                                                                                        </div>
                                                                                    </div>
                                                                                </footer>
                                                                            </section>
                                                                        </div>
																	{% else %}
																		<i class="fa fa-check"></i>
																	{% endif %}
																</li>
															{% endfor %}
														</ul>
													</li>	
													
												{% endfor %}
											</div>
                                            <footer class="panel-footer">
                                                <div class="row">
                                                    <div class="col-md-12 text-right">
                                                        <button class="btn btn-default modal-dismiss">Fermer</button>
                                                    </div>
                                                </div>
                                            </footer>
                                        </section>
									</div>
                    			</td>
                    		</tr>
                		{% else %}
                			<tr colspan="5"> 
                				Aucune classe
                			</tr>
                    	{% endfor %}
                    </tbody>
                </table>
            </div>
        </section>
    </div>
</div>

{% endblock %}

{% block javascripts %}
	
	<script src="{{ asset('assets/vendor/select2/select2.js') }} "></script>
	<script src="{{ asset('assets/vendor/jquery-datatables/media/js/jquery.dataTables.js') }} "></script>
	<script src="{{ asset('assets/vendor/jquery-datatables/extras/TableTools/js/dataTables.tableTools.min.js') }} "></script>
	<script src="{{ asset('assets/vendor/jquery-datatables-bs3/assets/js/datatables.js') }} "></script>
	<script src="{{ asset('assets/vendor/pnotify/pnotify.custom.js') }}"></script>
	<script src="{{ asset('assets/javascripts/ui-elements/examples.modals.js') }}"></script>
	<script src="{{ asset('assets/javascripts/forms/examples.advanced.form.js') }}" /></script>

	<script src="{{ asset('assets/vendor/jquery-ui/js/jquery-ui-1.10.4.custom.js') }}"></script>
	<script src="{{ asset('assets/vendor/jquery-ui-touch-punch/jquery.ui.touch-punch.js') }}"></script>
	<script src="{{ asset('assets/vendor/select2/select2.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-multiselect/bootstrap-multiselect.js') }}"></script>
	<script src="{{ asset('assets/vendor/jquery-maskedinput/jquery.maskedinput.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-tagsinput/bootstrap-tagsinput.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-colorpicker/js/bootstrap-colorpicker.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-timepicker/js/bootstrap-timepicker.js') }}"></script>
	<script src="{{ asset('assets/vendor/fuelux/js/spinner.js') }}"></script>
	<script src="{{ asset('assets/vendor/dropzone/dropzone.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-markdown/js/markdown.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-markdown/js/to-markdown.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-markdown/js/bootstrap-markdown.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/lib/codemirror.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/addon/selection/active-line.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/addon/edit/matchbrackets.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/mode/javascript/javascript.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/mode/xml/xml.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/mode/htmlmixed/htmlmixed.js') }}"></script>
	<script src="{{ asset('assets/vendor/codemirror/mode/css/css.js') }}"></script>
	<script src="{{ asset('assets/vendor/summernote/summernote.js') }}"></script>
	<script src="{{ asset('assets/vendor/bootstrap-maxlength/bootstrap-maxlength.js') }}"></script>
	<script src="{{ asset('assets/vendor/ios7-switch/ios7-switch.js') }}"></script>
	<script src="{{ asset('assets/javascripts/tables/examples.datatables.default.js') }}"></script>

		
{% endblock %}